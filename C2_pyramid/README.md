# C2-绘制一个彩色的四棱锥并添加光照效果

### 一、实验原理

#### 1.1 四棱锥

设置四棱锥4个三角形面和底面共18个顶点的坐标，颜色和法向量（其中，每个三角形面有3个顶点；底面由2个三角形面构成，有6个顶点）。

```c++
#define SQRT_TWO 1.414213562373095
float vertices[] = {
    0.0, SQRT_TWO, 0.0, 0.5, 0.5, 0.0, SQRT_TWO, 1.0, 0.0,
    1.0, 0.0, 1.0,      0.0, 0.5, 0.5, SQRT_TWO, 1.0, 0.0,
    1.0, 0.0, -1.0,     0.0, 1.0, 0.0, SQRT_TWO, 1.0, 0.0,

    0.0, SQRT_TWO, 0.0, 0.5, 0.5, 0.0, 0.0, 1.0, -SQRT_TWO,
    1.0, 0.0, -1.0,     0.0, 1.0, 0.0, 0.0, 1.0, -SQRT_TWO,
    -1.0, 0.0, -1.0,    0.5, 0.0, 0.5, 0.0, 1.0, -SQRT_TWO,

    0.0, SQRT_TWO, 0.0, 0.5, 0.5, 0.0, -SQRT_TWO, 1.0, 0.0,
    -1.0, 0.0, -1.0,    0.5, 0.0, 0.5, -SQRT_TWO, 1.0, 0.0,
    -1.0, 0.0, 1.0,     0.0, 0.0, 1.0, -SQRT_TWO, 1.0, 0.0,

    0.0, SQRT_TWO, 0.0, 0.5, 0.5, 0.0, 0.0, 1.0, SQRT_TWO,
    -1.0, 0.0, 1.0,     0.0, 0.0, 1.0, 0.0, 1.0, SQRT_TWO,
    1.0, 0.0, 1.0,      0.0, 0.5, 0.5, 0.0, 1.0, SQRT_TWO,

    1.0, 0.0, 1.0,      0.0, 0.5, 0.5, 0.0, -1.0, 0.0,
    1.0, 0.0, -1.0,     0.0, 1.0, 0.0, 0.0, -1.0, 0.0,
    -1.0, 0.0, -1.0,    0.5, 0.0, 0.5, 0.0, -1.0, 0.0,

    1.0, 0.0, 1.0,      0.0, 0.5, 0.5, 0.0, -1.0, 0.0,
    -1.0, 0.0, -1.0,    0.5, 0.0, 0.5, 0.0, -1.0, 0.0,
    -1.0, 0.0, 1.0,     0.0, 0.0, 1.0, 0.0, -1.0, 0.0,
};
```

#### 1.2 摄像机

为了便于进行视点和视角的变换，程序将摄像机的相关操作封装在``Camera``类中。其中保存摄像机的位置，朝向，欧拉角，视口大小等数据。

```c++
class Camera {
public:
    // camera Attributes
    glm::vec3 Position;
    glm::vec3 Front;
    glm::vec3 Up;
    glm::vec3 Right;
    glm::vec3 WorldUp;
    // euler Angles
    float Yaw;   // 偏航角
    float Pitch; // 俯仰角
    // camera options
    float MovementSpeed;
    float MouseSensitivity;
    float Zoom;
    unsigned int ScrWidth;
    unsigned int ScrHeight;
    float Aspect;
    // 其他数据...
}
```

#### 1.3 模型交互

利用OpenGL函数对键盘按键的监听，在每一次渲染时处理按下的按键，从而实现摄像机上下左右移动；利用鼠标的回调机制，实现视角的上下左右移动。

#### 1.4 光照

程序会将光的位置、反射材质因子和不同光的因子传入片段着色器中。

片段着色器会根据传入的数据，依据Phong光照模型计算环境光、漫反射光和镜面放射光。

### 二、实验步骤

#### 2.1 启动程序

直接执行``Output``文件夹中的C2_pyramid.exe**（确保glsl文件在``Code``文件夹中且exe文件在``Output``文件夹中）**

#### 2.2 交互方式

WASD键控制摄像机的移动，鼠标控制视角的移动

### 三、实验效果

![C2_pyramid](Report\C2_pyramid.png)

### 四、实验环境

Windows 10， OpenGL 3.3

依赖库：GLFW 3.3.2，Glad， GLM 0.9.9.7